%% 
%% Copyright 2007, 2008, 2009 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01

\documentclass[preprint,12pt, a4paper]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.

\usepackage{lineno}
\usepackage{amsmath}
\usepackage{float}
\usepackage[version=4]{mhchem}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{bm}

\restylefloat{table}

\usepackage{hyperref}

\newcommand{\BS}{\boldsymbol}

\journal{SoftwareX}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{RadLib: a radiative heat transfer model library for CFD}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \address[label1]{}
%% \address[label2]{}

%\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\author{Victoria B. Stephens}
\author{Sally Jensen}
\author{Isaac Wheeler}
\author{David O. Lignell\corref{cor1}}

\cortext[cor1]{Corresponding author. \ead{davidlignell@byu.edu}}

\address{Department of Chemical Engineering, Brigham Young University, Provo, UT 84602, United States}

\begin{abstract}
%% Text of abstract 
Ca. 100 words
\end{abstract}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword
radiative heat transfer \sep reacting flows  \sep CFD
\end{keyword}

\end{frontmatter}

\begin{table}[H]
\begin{tabular}{|l|p{6.5cm}|p{6.5cm}|}
\hline
\textbf{Nr.} & \textbf{Code metadata description} & \textbf{Metadata} \\
\hline
C1 & Current code version & TODO 2.1 \\
\hline
C2 & Permanent link to code/repository used for this code version & $github.com/BYUignite/radlib$ \\
\hline
C3 & Code Ocean compute capsule & (in review) \\
\hline
C4 & Legal Code License   & MIT license (MIT) \\
\hline
C5 & Code versioning system used & Git \\
\hline
C6 & Software code languages, tools, and services used & C++, Python 3 \\
\hline
C7 & Compilation requirements, operating environments \& dependencies & CMake, C++, Python 3, Cython \\
\hline
C8 & If available Link to developer documentation/manual & TODO \\
\hline
C9 & Support email for questions & davidlignell@byu.edu \\
\hline
\end{tabular}
\caption{Code metadata.}
\label{} 
\end{table}


\linenumbers

% TODO tag software version

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Motivation and significance} \label{s:motivation}

Modeling radiative heat transfer for CFD is complex and challenging. Combustion simulations, for example, which require many physics models, are often complicated by the need for accurate radiation modeling, which can be difficult to implement and computationally expensive relative to simulation cost. This can lead to simulations that use oversimplified radiation models, but in cases where radiation is significant relative to the other physical phenomena, oversimplified models can negatively impact the accuracy of simulation results. In some cases, radiative gains or losses are small compared to other energy sources or heat transfer modes and radiation can be safely neglected, but many practical engineering systems do not allow this. For example, simple jet flames demonstrate both possibilities: early in a flame's development, turbulent mixing typically dominates heat transfer and dictates flame behavior; late-stage flame phenomena like soot behavior and flame sheet breakthrough, however, increasingly depend on the magnitude of radiative heat losses and are difficult to simulate accurately without a robust radiation model. These problems motivated development of the RadLib library, which provides a framework and uniform interface for radiation property models and implements three powerful models in C++ and Python, giving researchers more convenient access to advanced radiation property models and a consistent framework for further model development. 

The core mechanisms of radiative phenomena are physically and mathematically complex. Unlike other modes of heat transfer, radiation is governed by a set of integro-differential equations that depend on both direction and wavelength, known as the radiative transfer equations (RTE). Solving the RTE for a given system also requires information about the radiative properties of the materials and media involved, typically radiation absorption coefficients. These absorption coefficients are dependent on a number of local system properties such as temperature, pressure, and gas composition. As a result, computational radiation solvers require two parts: first, a solution approach for the radiative transfer equations (RTE); and second, a radiation property model. RadLib addresses the second part by providing a set of implemented and validated radiation property models that can be applied to various solution approaches for the RTE.

%Like combustion, the core mechanisms of radiation are physically and mathematically complex. Unlike other modes of heat transfer, radiation is governed by a set of integro-differential equations that depend on both direction and wavelength. Only the simplest systems have analytic solutions, and most practical systems require a numerical solution. Ray tracing solutions are very accurate but extremely computationally expensive, and often require high-performance computing resources to execute. Modeling assumptions are common and can reduce simulation cost at the expense of accuracy, depending on their validity for the system in question. 

With RadLib, we provide a convenient, easy-to-use access point for radiative property models that can be interfaced with various RTE solution approaches suitable for CFD applications. RadLib is a modular C++ library with an optional Python interface used to compute the radiation properties of participating media, which can be a difficult and time-consuming portion of radiation calculations. RadLib's current focus is calculating radiation absorption coefficients and weighting factors for use in global radiation models, but the expansion to other radiative properties is possible. Three models are fully implemented and validated and use a common interface, allowing researchers convenient access to radiation modeling tools suitable for various applications.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Model descriptions} \label{s:models}

The RTE for intensity $I$ in (unit) direction $\mathbf{s}$ for an absorbing, emitting, and non-scattering medium is described by
% 
\begin{linenomath}
\begin{equation} \label{e:RTE_general}
    \frac{dI_{\eta}}{ds} = -\kappa_{\eta}I_{\eta} + \kappa_{\eta}I_{b,\eta},
\end{equation}
\end{linenomath}
%
where $I_{\eta}$ is the radiative spectral intensity, 
$I_{b\eta}$ is spectral blackbody intensity (or Planck function), 
$\kappa_{\eta}$ is the spectral absorption coefficient of the medium, and $s$ is a pathlength along direction $\mathbf{s}$. Radiation property models such as those implemented by RadLib are used to calculate the absorption coefficients $\kappa_{\eta}$. 
%
The gas absorption spectrum is an extremely complex function consisting of millions of spectral lines (peaks) corresponding to quantum mechanical energy levels of the gas molecules.
Direct solution of Eq.~\ref{e:RTE_general}, involves so-called \emph{line-by-line} calculations that are computationally prohibitive for most practical calculations, and are used primarily for model validation. Global models are an important class of radiation property models that make use of spectrally-integrated radiation properties and are usually versions of the weighted sum of gray gases (WSGG) model \cite{Hottel_1967,Modest_2013}. For instance, integrating Eq.~\ref{e:RTE_general} over fixed spectral ranges $\eta_j$ and assuming gray (spectrally uniform) properties in each region $j$, (that is, in each \emph{gray gas} $j$), gives
%
\begin{linenomath}
\begin{equation} \label{e:RTE_wsgg}
	\frac{dI_j}{ds} = -\kappa_jI_j + a_j\kappa_jI_b, \hspace{20pt} j=0,1,...,n,
\end{equation}
\end{linenomath}
%
where $a_j$ is a weight factor defined as
%
\begin{linenomath}
\begin{align}
    &a_j= \frac{\int_{\eta_j}I_{b,\eta}d\eta}{I_b},\\
    &\sum_j a_j = 1.
\end{align}
\end{linenomath}
%
Given spatial profiles of $\kappa_j$ and $a_j$, Eq.~\ref{e:RTE_wsgg} can be computed for each of the $n+1$ gray gases. Normally, the $j=0$ gas is considered as a clear gas and represents \emph{transparent windows} in the spectrum for which $\kappa_0=0$.
The total radiative intensity $I$ is calculated by summing the individual gray gas intensities:
%
\begin{linenomath}
\begin{equation}
	I=\int_{\eta=0}^{\infty}I_{\eta}d\eta=\sum_{j=1}^n I_j.
\end{equation}
\end{linenomath}
%
In the above, $I$ is a function of direction $\mathbf{s}$. The heat flux vector $\mathbf{q}$ is found by integrating over directional solid angles ($\mathbf{s}\Omega$) on the sphere:
%
\begin{linenomath}
\begin{equation}
    \mathbf{q} = \int_{4\pi}I(\mathbf{s})\mathbf{s}d\Omega.
\end{equation}
\end{linenomath}
%
The volumetric radiative heat source is then 
%
\begin{linenomath}
\begin{equation}
    Q = -\nabla\cdot\mathbf{q}.
\end{equation}
\end{linenomath}
%

RadLib currently implements three models of varying complexity and accuracy to calculate the radiation absorption coefficients $\kappa_j$ and their weight factors $a_j$ for each gas $j$. The absorption coefficients are typically calculated using correlations relating them local properties such as temperature, pressure, and composition. Correlations come from curve fits to high-resolution radiation property databases. At present, RadLib considers up to four gas species (H$_2$O, CO, CO$_2$, and CH$_4$) and soot. 

While solving the RTE is not the focus of this software, RadLib's example cases do employ a simple ray tracing solver to calculate the radiative heat flux and volumetric heat source profiles between two parallel planes. 

%[OTHER THINGS THAT APPLY TO ALL MODELS GO HERE]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Planck Mean absorption coefficients} \label{s:planckmean}

RadLib's simplest model uses Planck Mean absorption coefficients calculated from the correlations given on the TNF Workshop site \citep{Smith_2003}. The temperature-dependent correlations are based on the RADCAL model \citep{Grosshandler_1993}. The TNF radiation model is also documented in \citep{Barlow_2001}.

Planck Mean absorption coefficients are commonly used to model radiation, especially in combustion systems, because the model is relatively easy to implement, computationally inexpensive, and reasonably accurate in some cases. The Planck Mean model is most appropriate under optically thin conditions with relatively low radiative transfer relative to other heat sources such as reactive heat release rates. In cases where the optically thin assumption applies, such as simple hydrogen jet flames, this model and the associated Planck Mean absorption coefficients can produce accurate results \citep{Barlow_1999}. In cases where the optically thin assumption is not reasonable, including many other combustion scenarios, the Planck Mean model does not produce accurate results. For example, it significantly overpredicts radiative losses from the TNF library's CH$_4$ flames \cite{Frank_2000,Zhu_2002,Coelho_2002}. The examples included with the code and illustrated in Section \ref{s:Examples} demonstrate the deficiencies of the Planck Mean model in comparison to the others included with RadLib.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Weighted sum of gray gases (WSGG)} \label{s:wsgg}

The WSGG model was outlined in Sec.~\ref{s:models}.
RadLib implements the WSGG model presented by Bordbar et al. \citep{Bordbar_2014,Bordbar_2020}, which uses correlations based on the HITEMP 2010 database \cite{Rothman_2010}. It uses four gray gases and one transparent gas, and considers gaseous species \ce{CO2} and \ce{H2O}. This version of the WSGG model has the advantage over some others in that it allows for arbitrary \ce{CO2} and \ce{H2O} compositions, increasing its accuracy and flexibility. Absorption coefficients are calculated by 
%
\begin{linenomath}
\begin{equation}
    \kappa_j=\sum_{k=0}^{4}d_{j,k}M_r^k,
\end{equation}
\end{linenomath}
%
where $\kappa_j$ is the absorption coefficient for gray gas $j$, $d_{j,k}$ is a correlated model coefficient, and $M_r$ is the molar ratio $y_{\mathrm{H_2O}}/y_{\mathrm{CO_2}}$. The weight factors are calculated by 
%
\begin{linenomath}
\begin{equation}
    a_j=\sum_{k=0}^{4}b_{j,k}T_r^k,
\end{equation}
\end{linenomath}
%
where $a_j$ is the weighting factor for gas $j$ and $T_r$ is a scaled temperature equal to $T/T_{ref}$ with $T_{ref}=1200$K. The value of $b_{i,j}$ is calculated by 
%
\begin{linenomath}
\begin{equation}
 b_{j,k}=\sum_{i=0}^{4}C_{j,k,i}M_r^i,
\end{equation}
\end{linenomath}
%
where $C_{j,k,i}$ is another correlated model coefficient. The model coefficients $d_{j,k}$ and $C_{j,k,i}$ are provided by Bordbar et~al. \citep{Bordbar_2014,Bordbar_2020}. 

The correlations provided in \cite{Bordbar_2014} are valid for $0.01\le M_r\le4$. In \cite{Bordbar_2020} this range was extended to arbitrary $M_r$ by interpolation of $\kappa_j$ and $a_j$ between the pure component values and the corresponding limit on $M_r$, that is, for \ce{CO2}: interpolation between values at $M_r=0.01$ and pure \ce{CO2}; and for \ce{H2O}: interpolation between values at $M_r=4$ and pure \ce{H2O}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Rank Correlated SLW (RCSLW)} \label{s:RCSLW}

The Spectral Line Weighted-Sum-of-Gray Gases (SLW) model represents a family of global approaches to radiative heat transfer in high-temperature gases that also includes Absorption Distribution Function (ADF) and Full Spectrum $k$-distribution (FSK) models, all of which are based on the same fundamental principle in modeling the gas absorption spectrum \cite{Solovjov_2016}. In order to extend their spectral models from uniform conditions (isothermal, homogeneous gases) to nonuniform conditions (non-isothermal, non-homogeneous gases), these models take a reference approach in which local gas states are corrected relative to a reference state. Reference approaches, however, generally lack consistent reference states and can yield significant errors in cases with large spatial temperature gradients \cite{Solovjov_2017}. The Rank Correlated SLW (RCSLW) model is a unique extension of the generalized SLW model that does not require a specified gas reference state and preserves the emission term of the spectrally integrated RTE. 
% TODO: what does this last phrase mean: preserves the emission...?
%
Recent comparison of advanced SLW modeling approaches revealed that ``the Rank Correlated SLW model is the most robust of all models, and demonstrates that it can achieve accurate solutions with as few as 3–5 gray gases" \citep{Badger_2019}. A brief overview of the RCSLW model is given here; detailed discussion can be found in the literature \cite{Solovjov_2000, Solovjov_2001, Solovjov_2008, Solovjov_2011, Solovjov_2014, Solovjov_2016, Solovjov_2017, Webb_2018}. 
Solovjov et al.~\cite{Solovjov_2017} present a number of methods within a generalized framework, with method I.2.2 giving the best results. That is the method implemented and summarized here.
%

SLW models are written in terms of absorption cross section $C_\eta(\eta)$, where $\kappa_\eta=C_\eta N$, and $N$ is the molar density of the radiatively participating gas. 
%
SLW models are similar to WSGG models, but instead of integrating within a sequential band of $\eta$ to define gray gas $j$, spectral integration is done over a set of (nonsquential) wavenumbers constituting a given band $j$ of $C_\eta$. Consider the set of wavenumbers $\tilde{H}_j=\{\eta:C_\eta<\tilde{C}_j\}$, then $\Delta_j=\tilde{H}_j-\tilde{H}_{j-1} = \{\eta:\tilde{C}_{j-1}<C_\eta<\tilde{C}_j\}$ is the set of wavenumbers constituting gas $j$ in Eq.~\ref{e:RTE_wsgg}. (Here, we are using the notation in \cite{Solovjov_2017}.)
%
The SLW gases, then, are gray in a given band by definition, at least to within the width $\tilde{C}_j-\tilde{C}_{j-1}$. In contrast, in traditional WSGG approaches, the gases are only conceptually gray, and the absorption coefficients and weights are determined empirically \cite{Badger_2019}. 

A gas weight $a_j$ is the fraction of blackbody emission from $\eta\in\Delta_j$ corresponding to a given cross-section band $j$. This energy is computed using the absorption line blackbody distribution function (ALBDF) \cite{Pearson_2014}, which gives the fraction of total blackbody emission from $\eta$ corresponding to absorption cross sections less than $C$: 
%
\begin{linenomath}
    \begin{equation} \label{e:albdf}
        F(C,\BS{\phi},T) = \frac{1}{\sigma T^4}\int_{\{\eta:\,C_\eta(\eta,\BS{\phi})<C\}}E_b(\eta,T)d\eta,
\end{equation}
\end{linenomath}
%
so that
%
\begin{linenomath}
\begin{equation}
    a_j = F(\tilde{C}_j,\BS{\phi}, T) - F(\tilde{C}_{j-1}, \BS{\phi},T).
\end{equation}
\end{linenomath}
%
%todo: deal with T versus Tb in e:albdf and previous eqn.
Note that $F$ varies between zero and one, and is monotonic in $C$, allowing calculation of the inverse $C(F,\BS{\phi},T_b)$.

The WSGG RTE in Eq.~\ref{e:RTE_wsgg} assumes the sets $\Delta_j$ are independent of spatial position $\mathbf{x}$, but care must be taken since $C_\eta$ depends on the thermodynamic state (denoted by vector $\BS{\phi}$ with nominal components $T$, $P$, and $y_i$), which does vary spatially. That is, $C_\eta=C_\eta(\eta,\BS{\phi}(\mathbf{x}))$. Hence, spatially-fixed $\Delta_j$ with spatially varying $\BS{\phi}$ imply a spatial variation in $C_j$ and $\tilde{C}_j$.
 
The RCSLW model uses the notion of \emph{rank correlation} to compute this variation in $C_j$ and $\tilde{C}_j$. Solovjov et~al.~\cite{Solovjov_2017} define two spectra at states $\BS{\phi}_1$ and $\BS{\phi}_2$ to be rank correlated if, for an arbirary wavenumber $\hat{\eta}$, the wavenumber sets $H_1(\BS{\phi}_1)$ and $H_2(\BS{\phi}_2)$ are equal, where 
%
\begin{linenomath}
\begin{align}
    H_1(\BS{\phi}_1)&=\{\eta: C_\eta(\eta,\BS{\phi}_1)<C_\eta(\hat{\eta},\BS{\phi}_1)\}, \\
    H_2(\BS{\phi}_2)&=\{\eta: C_\eta(\eta,\BS{\phi}_2)<C_\eta(\hat{\eta},\BS{\phi}_2)\}. 
\end{align}
\end{linenomath}
%

Consider Eq.~\ref{e:albdf} at fixed argument $T=T_r$, and let $\hat{C}_1\equiv C_\eta(\hat{\eta},\BS{\phi}_1)$, and similarly for $\hat{C}_2$; then we have
%
\begin{linenomath}
    \begin{align} \label{e:albdf2}
        F(\hat{C}_1,\BS{\phi}_1,T) &= \frac{1}{\sigma T^4}\int_{H_1(\BS{\phi_1})}E_b(\eta,T_r)d\eta, \\
        F(\hat{C}_2,\BS{\phi}_2,T) &= \frac{1}{\sigma T^4}\int_{H_2(\BS{\phi_1})}E_b(\eta,T_r)d\eta.
    \end{align}
\end{linenomath}
%

 
%Note in Eq.~\ref{e:albdf}, that $\BS{\phi}$ determines $C_\eta$, which then determines the set of $\eta$ integrated over. But for a \emph{given} set $\eta$, e.g., $H_1$, $F$ can be considered as $F(C,T)$. Hence, if $H_1=H_2$, then at a fixed reference black temperature $T_{ref}$, we have $F(C_1,\BS{\phi}_1,T_{ref})=F(C_2,\BS{\phi}_2,T_{ref})$. One can then compute the inverse to find $C_1$ at $\BS{\phi}_1$ and $C_2$ at $\BS{\phi}_2$ (i.e., values at two spatial positions) corresponding to the same wavenumber interval. 

In practice, for a given problem, a grid of $\tilde{F}_j$ points are specified, with $F_j$ points between $\tilde{F}_j$ and $\tilde{F}_{j-1}$. The corresponding $\tilde{C}_j$ and $C_j$ values at any spatial position can then be found by inversion: $C_j = C(F_j,\BS{\phi},T_{ref})$, and similarly for $\tilde{C}_j$ in terms of $\tilde{F}_j$. $\kappa_j$ and $a_j$ can then be computed as noted above.
%TODO verify this in terms of the quadrature.














%The RCSLW model begins with the SLW form of the RTE, given by Eq.~\ref{e:RTE_SLW}. The gray gas absorption coefficients $\kappa_j$ are calculated calculated as $\kappa_j=N \sqrt{C_{j-1}C_j}$,
%where $C_{j-1}$ and $C_j$ are supplemental absorption cross-sections used to discretize the absorption spectrum \cite{Solovjov_2001}. The gray gas weights $a_j$ corresponding to each absorption coefficient are given by $a_j=F(C_j)-F(C_{j-1})$, where $F(C_j)$ is the absorption line blackbody distribution function (ALBDF) for species $j$, calculated from the detailed absorption spectrum of that species. In general SLW methods, the absorption cross-sections are chosen with respect to a thermodynamic reference state, classifying them as reference approaches. The Rank-Correlated SLW (RCSLW) model avoids specifying a reference state by relating thermodynamic states to one another instead. If two arbitrary absorption cross-sections define identical wavenumber intervals, the two cross-sections (neither of which is designated a reference cross-section) can be said to be rank-correlated. The inverse ALBDF, defined such that $C[F(C,\phi_g,T_b),\phi_g,T_b]=C$ and $F[C(F,\phi_g,T_b),\phi_g,T_b]=F$ for a given gas thermodynamic state $\phi_g$ and blackbody temperature $T_b$, is proven to have this property and can also be called the rank-correlated reordered absorption cross-sections \cite{Solovjov_2017}. As a result, the inverse ALBDF can be used to construct cross-section intervals for the RCSLW model that do not rely on an arbitrary reference state or spectrum. ALBDFs for individual gray gases are multiplied together to obtain an overall ABLDF for the gas mixture \cite{Solovjov_2001}. RadLib's RCSLW model uses Method 1.2.2 as defined in and recommended by \cite{Solovjov_2017}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Soot} \label{s:soot}

RadLib can also account for the radiative properties of soot in combustion environments. Soot particles are assumed to be unagglomerated spheres that absorb and emit radiation at all wavelengths such that their optical properties can be determined using the Rayleigh small particle limit. Radiation scattering may be neglected because unagglomerated soot particles in the Rayleigh regime are still small relative to the wavelength of infrared radiation in flames \cite{Brewster_1992,Solovjov_2001}. The spectral soot absorption coefficient is given by 
%
\begin{linenomath}
\begin{equation}
\label{e:soot1}
	\kappa_{s,\eta}=C_0 f_v \eta, \; \; \; C_0 = \frac{36\pi n k}{(n^2-k^2+2)^2+4n^2k^2},
\end{equation}
\end{linenomath}
%
where $n$ and $k$ are the real and imaginary parts of the soot complex index of refraction, respectively, and $f_v$ is the soot volume fraction \cite{Solovjov_2001,Modest_2013}. Various values for the refraction index have been proposed and applied \cite{Lee_1981,Stull_1960,Dalzell_1969,Howarth_1966,Chang_1990,Felske_1984,Williams_2007}. 
% INSERT FIGURE SHOWING DIFFERENT MODELS
RadLib uses the values $n=1.75$ and $k=1.03$ given in \cite{Williams_2007}, which result in a value of $C_0=7.03$, which is nearly the same as the value $C_0=7.0$ used in \cite{Solovjov_2001}. 
The Planck mean and Rosseland mean soot absorption coefficients are given in \cite{Modest_2013} as $\kappa_s=3.83f_vC_0T/C_2$ and $\kappa_s=3.60f_vC_0T/C_2$, respectively.
Due to the small difference between the coefficients in these two expressions, a mean value is suggested \cite{Felske_1977,Modest_2013}:
%
\begin{linenomath}
\begin{equation}
\label{e:soot2}
	\kappa_{soot}=3.72\frac{f_vC_0T}{C_2},
\end{equation}
\end{linenomath}
%
where $T$ is the temperature and $C_2=0.014388$ \si{m.K} is a Planck function constant \cite{Modest_2013}. 

In the Planck Mean model, which treats a gas mixture as one gray gas, the soot absorption coefficient calculated from Eq.~\ref{e:soot2} is added to the gas absorption coefficient. This gives $\kappa_s=1817f_vT$ \si{m^{-1}}.
 
In the WSGG model, Bordbar suggested incorporating soot as follows \cite{Bordbar_personal}. The soot absorption coefficient is similarly calculated from Eq.~\ref{e:soot2} but is then added to each of the gases separately. Because soot radiates across all wavelengths, its absorption coefficient is added to the values of all four gray gases and the clear gas. The gas weights $a_j$ are not changed. This model yeilds the expected behavior for the soot-only and gas-only limits.

The soot model used in the WSGG model can be applied to the RCSLW model as well. However, the formulation of the RCSLW model allows for a spectral soot treatment in the same manner as for the gas species~\cite{Solovjov_2001}. Calculation of the soot ALBDF is facilitated by the simple $\eta$ dependence of $\kappa_{s,\eta}$ in Eq.~\ref{e:soot1}. The fraction of the black energy at wavenumbers below $\eta$ is computed directly using a series expansion from Chang and Rhee \cite{Chang_1984,Solovjov_2001}. The soot ALBDF is then included in the product of species ALBDFs to obtain the mixture ALBDF. 
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Software Description} \label{s:architechture}

RadLib is an object-oriented C++ class library that includes both C++ and Python interfaces. The RadLib package contains five subdirectories (upon initial download): \texttt{source} contains the RadLib source code; \texttt{build} contains installation files; \texttt{examples} contains instructive example cases, including a simple interface and solver for a parallel planes geometry; \texttt{data} contains ALBDF data tables required for the RCSLW model; and \texttt{docs} contains files used to generate code documentation with Doxygen (optional). 

The \texttt{source} and \texttt{examples} directories are further divided into \texttt{C++} and \texttt{Python} subdirectories to differentiate between interfaces. There are three interface options for using this code: C++, Python, and Cython-wrapped Python. C++ interfaces are located within the \texttt{examples/c++} folder, while Python interfaces are located within the \texttt{examples/python} folder. When running examples with Python, the Cython-wrapped version is the default; to run the regular Python version without the Cython wrapper, edit the comments near the top of the example files (i.e \texttt{ex\textunderscore S1.py}). The C++ interface produces the fastest-running code, followed by the Cython-wrapped Python interface and then the regular Python interface. [INSERT RUNTIME COMPARISONS HERE]

RadLib installation is automated with CMake. First, navigate to the \texttt{radlib/build} directory. If the user requires an installation location other than the default \texttt{radlib/installed} directory, edit the \texttt{user\textunderscore config} file before running CMake. To compile the package, run the command \texttt{cmake -C user\textunderscore config ../source}. Upon successful completion, run \texttt{make} and then \texttt{make install} to complete the process. The generated C++ library file is located at \texttt{radlib/installled/lib/libradlib.a}. 

Figure \ref{fig:flowchart} illustrates the basic structure use of the RadLib package within a generic example using the provided interfaces. The RadLib library generates absorption coefficients and their weighting factors for use within the appropriate RTE, but does not specify any particular geometry, making it a versatile tool for any simulation that requires radiative heat transfer, regardless of configuration. The interfaces, solver, and examples included with the library serve to illustrate its use and validate the implementation and results. 
%
\begin{figure}
	\begin{center}
		\includegraphics[width=\textwidth]{../figures/radlib_structure.pdf}
	\end{center}
	\caption{Example workflow diagram. Highlighted areas are part of the RadLib library; other areas represent example infrastructure for using the package.}
\label{fig:flowchart}
\end{figure}
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Illustrative Examples} \label{s:Examples}

Several examples are presented to illustrate the behavior of the models. The examples show heat flux $q$ or volumetric heat source $Q$ in one one-dimensional configurations with varying gas compositions and temperatures. We compare the PM, WSGG, and RCSLW models for each example. The examples correspond to those presented by Solvojov et al. (S) \cite{Solovjov_2017} and Bordbar et al. (B) \cite{Bordbar_2020}, and the number of each example corresponds to the example number in the respective reference. A ray-tracing code is used to solve the radiative transport equation between two parallel plates. 
Table~\ref{t:examples} summarizes the cases. Example S1 is a hot slab next to a cold slab where the cold slab's thickness varies; Example S2 is isothermal with a thick slab of high CO$_2$ next to a thin slab of low CO$_2$ with variable thickness; Example S3 uses parabolic temperature and H$_2$O mole fraction profiles; Example S4 has a triangular temperature profile between equally-spaced isothermal regions; Example S5 uses a half-sinusoid temperature profile that decreases from 1500 to 500 K; and Example B3 has symmetric temperature and H$_2$O mole fraction profiles with central peaks of 1800 K and 1, respectively (with $y_{CO2}=1-y_{H2O}$). Each case is presented alongside the line-by-line (LBL) data presented in the references. 
%
\begin{table}
    \caption{Summary of example cases presented. S1-S5 are from \cite{Solovjov_2017}; B3 is from \cite{Bordbar_2020}. All cases use $P=1$ atm and black walls.}
    \label{t:examples}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{c l l c c c}
        \hline
        Example & T(K)                           & $y_{H2O}$  $y_{CO2}$ (mole frac.)                     & L (m)   & $T_{walls}$ (K)\\
        \hline
        S1 & $T(x<0.5)=2000$; $T(x>0.5)=300$     & $y_{CO2}=0.1$, $y_{H2O}=0.2$                          & 0.5-2.5 & cold, cold     \\
        S2 & T=1000                              & $y_{CO2}(x<0.5)=0.4$, $y_{CO2}(x>0.5)=0.1$            & 0.5-2.5 & cold, cold     \\
           &                                     & $y_{H2O}=0.0$                                         &         &                \\
        S3 & $T(x) = 4000x(L-x)/L^2 + 800$       & $y_{H2O}(x) = 0.8x(L-x)/L^2 + 0.12$                   & 1       & 800, 800       \\
           &                                     & $y_{CO2}=0$                                           &         &                \\
        S4 & middle third triangular to 2500     & $y_{H2O}=0.1$, $y_{CO2}=0$                            & 0.3     & 500, 500       \\
        S5 & $T(x) = 1000 + 500\cos(\pi x/L)$    & $y_{H2O}=0.1$, $y_{CO2}=0$                            & 2       & 1500, 500      \\
        B3 & $T(x) = 400 + 1400\sin(\pi x/L)^2$  & $y_{H2O}(x) = 0.0001 + 0.9999\sin(\pi x/L)^2$         & 1       & 400, 400       \\
           &                                     & $y_{CO2}=1-y_{H2O}$                                   &         &                \\
        \hline
    \end{tabular}
    }
\end{table}
%

The examples are provided with the RadLib code and implemented in both C++ and Python. A Juptyer notebook is provided with the Python examples that runs the examples, displays the plots, and saves the plots to PDF files. Python and Cython versions of the one-dimensional solver \texttt{parallel\textunderscore planes.py} are provided for convenience. 

These cases are intended to illustrate the use of the RadLib library and are not exhaustive. Details about these examples and their motivations can be found in their respective references. While ommitted here for brevity, the implemented WSGG and RCSLW models give essentially identical results to those presented in \cite{Solovjov_2017,Bordbar_2020} such that these examples also serve as a validation of the implementation of the models.

Figure~\ref{f:examples} shows comparative results for the different radiation models for these cases. 
%
\begin{figure}
    \begin{center}
    \begin{tabular}{c c}
        Example S1 & Example S2 \\
        \includegraphics[width=3 in]{ex_1.pdf} &
        \includegraphics[width=3 in]{ex_2b.pdf} \\
        Example S3 & Example S4 \\
        \includegraphics[width=3 in]{ex_3a.pdf} &
        \includegraphics[width=3 in]{ex_4a.pdf} \\
        Example S5 & Example B3 \\
        \includegraphics[width=3 in]{ex_5b.pdf} &
        \includegraphics[width=3 in]{ex_6.pdf}
    \end{tabular}
    \caption{Results for examples summarized in Table~\ref{t:examples}.}
    \label{f:examples}
    \end{center}
\end{figure}
%
In general, the PM model performs poorly compared to the WSSGG and RCSLW models. A notable exception is Example S4. In Example S2, the PM $q(L)/\sigma T^4$ is off scale at an essentially constant at a value of unity. The PM absorption coefficient is 27.4 atm$^{-1}$m$^{-1}$, giving optical thicknesses of 0.09 and 0.36 m in the thick and thin layers, respectively, which are relatively small compared to the isothermal domain size greater than 0.5 m. Example S5 omits the PM model to more clearly show the behavior of the WSGG and RCSLW models. For that example, the PM values follow the shape of the other curves but $Q$ varies from around -80 at $x=0$ to a peak of 200 at x=$1.5$ m, and dropping to 100 kW/m$^3$ at $x=2$ m. In all examples, four gray ($n=4$) and one clear gas are computed for the RCSLW models to give a consistent comparison to the WSGG model. Example S5 shows the sensitivity of the RCSLW model to the number of gases used. When $n$ is increased to eight the RCSLW model improves to show nearly perfect agreement with the LBL data in Example S2.
In all Examples, the RCSLW model is initialized using the mean temperature and composition on the domain. In Example S5, the RCSLW model converges to the LBL solution when the model is initialized using the maximum temperature instead of the average temperature.

% TODO: do the cost comparison  <13-11-20, dol> %

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Impact} \label{s:impact}

Radiative heat transfer models are historically difficult to implement in CFD codes due to their complexity and high computational costs. Neglecting radiation or using simple models like the optically thin assumption is adequate for some cases with simple geometry or limited chemical reactions, but most simulations of interest to engineers and researchers require more advanced radiation modeling to yield accurate results. In such cases, radiation models that are incorrectly implemented or inappropriate for the simulation parameters can become additional sources of error that may be extremely difficult to separate from existing sources or error. Currently, researchers that require detailed radiation modeling must code and validate it themselves at the expense of valuable research time and funding. 

RadLib makes researchers' work easier by consolidating various approaches into a modular library of interchangeable, prevalidated radiation models. Additionally, RadLib's modular framework is designed to easily accommodate new models as well, allowing researchers to compare new or existing models with very little overhead. Sometimes, it is not clear which radiation model may be the best fit for a particular simulation. When simulations are especially complex or computationally expensive, researchers may have to extrapolate from theory and literature to choose an appropriate radiation model rather than testing for their specific case. RadLib is designed to ease both of these obstacles by facilitating comparison between radiation models through a common interface and providing a practical means of testing various models without the restriction of prespecified geometry or case parameters. With RadLib, researchers can put more of their time and effort into useful results rather than code or model development. 

Currently, RadLib is only used within the authors' research group, where it is applied to combustion CFD simulations using the One-Dimensional Turbulence (ODT) model \cite{Stephens_2020}, but its design and structure as a C++ library allows it to be incorporated easily into existing codes. It can be applied to  research questions in various other fields involving radiative heat transfer as well, including energy engineering or atmospheric and climate sciences. Radiation is a universal phenomenon, and RadLib can assist researchers in many areas with systems and processes that involve heat transfer. 

%Author guidelines for this section
%\begin{itemize}
% \item \textbf{This is the main section of the article and the reviewers weight the description here appropriately}
% \item Indicate in what way new research questions can be pursued as a result of the software (if any).
% \item Indicate in what way, and to what extent, the pursuit of existing research questions is improved (if so).
% \item Indicate in what way the software has changed the daily practice of its users (if so).
% \item Indicate how widespread the use of the software is within and outside the intended user group.
% \item Indicate in what way the software is used in commercial settings and/or how it led to the creation of spin-off companies (if so).
%\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Conclusions} \label{s:conclusions}

Set out the conclusion of this original software publication.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Conflict of Interest} \label{s:coi}

There are no known conflicts of interest associated with this publication and there has been no significant financial support for     this work that could have influenced its outcome.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Acknowledgements} \label{sec:acknowledgements}

The authors extend special thanks to Hadi Bordbar for assistance with the WSGG model and to Vladimir Solovjov and Brent Webb of Brigham Young University for their insights and assistance with the RCSLW model. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{elsarticle-num} 
\bibliography{references} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Current executable software version} \label{s:current_software}

%Ancillary data table required for sub version of the executable software: (x.1, x.2 etc.) kindly replace examples in right column with the correct information about your executables, and leave the left column as it is.

\begin{table}[!h]
\begin{tabular}{|l|p{6.5cm}|p{6.5cm}|}
\hline
\textbf{Nr.} & \textbf{(Executable) software metadata description} & \textbf{Metadata} \\
\hline
S1 & Current software version & 1.0 \\
\hline
S2 & Permanent link to executables of this version  & \href{https://github.com/BYUignite/radlib}{https://github.com/BYUignite/radlib} \\
\hline
S3 & Legal Software License & MIT license (MIT) \\
\hline
S4 & Computing platforms/Operating Systems & Linux, OS X, Microsoft Windows\\
\hline
S5 & Installation requirements \& dependencies & CMake, C++, Python 3, Cython \\
\hline
S6 & If available, link to user manual - if formally published include a reference to the publication in the reference
    list & \href{https://github.com/BYUignite/radlib}{https://github.com/BYUignite/radlib} \\
\hline
S7 & Support email for questions & davidlignell@byu.edu \\
\hline
\end{tabular}
\caption{Software metadata.}
\label{} 
\end{table}

\end{document}
\endinput
